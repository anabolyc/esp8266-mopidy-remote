<!--http://192.168.4.1/ajax/get-networks-->
<!--http://192.168.4.1/ajax/connect     -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Sming Framework WiFi Network configuration</title>

    <!-- Bootstrap core CSS -->
    <!-- build:css bootstrap-core.css -->
    <link href="bootstrap.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <!-- endbuild -->

    <!-- build:js core.js -->
    <script src="jquery.js"></script>
    <!-- endbuild -->

</head>
<script>
    $(document).ready(function () {
        App.GetVars();
        App.Events.CreateNew();
    });

    var App = {
        Host: "http://192.168.1.97",
        GetVarsUrl: '/ajax/vars',
        GetVars: function () {
            $('#floatingCirclesG').show();
            $.ajax({
                url: App.Host + App.GetVarsUrl,
                method: 'GET'
            }).always(function () {
                $('#floatingCirclesG').hide();
            }).done(function (data) {
                App.SetVars(data);
            }).fail(function (jqXHR, textStatus, errorThrown) {
                console.log(textStatus);
            });
        },
        SetVars: function (data) {
            console.log("SetVars", data);
        },
        CreateNew: function () {
            $('#floatingCirclesG').show();
            $.ajax({
                url: App.Host + App.GetVarsUrl,
                method: 'PUT',
                data: {
                    key: $("#new-name").val().trim(),
                    value: $("#new-value").val().trim()
                }
            }).always(function () {
                $('#floatingCirclesG').hide();
            }).done(function (data) {
                App.GetVars();
            }).fail(function (jqXHR, textStatus, errorThrown) {
                console.log(textStatus);
            });
        },
        Events: {
            CreateNew: function () {
                $('.create-input').on('change', function($e) {
                    if ( $('.create-input').filter(function() {
                            return this.value.trim().length == 0;
                        }).length == 0 
                    ) 
                        $('.create').removeClass('disabled');
                    else
                        $('.create').addClass('disabled');
                });
                $('.create').on('click', function () {
                    App.CreateNew()
                });
            }
        }
    };
</script>

<body>

    <div class="container">
        <div class="jumbotron">
            <h2>Consts</h2>

            <p class="lead">User defined consts
            </p>
        </div>

        <div class="row">
            <div class="col-lg-2">
                <input type="text" class="form-control form-control-sm create-input" id="new-name" placeholder="name"/>
            </div>
            <div class="col-lg-4">
                <input type="text" class="form-control form-control-sm create-input" id="new-value" placeholder="value"/>
            </div>
            <div class="col-lg-6">
                <button class="btn btn-success disabled create">Create New</button>
            </div>
            <div class="col-lg-6 col-md-offset-3">
                <div class="error"></div>

                <div id="floatingCirclesG">
                    <div class="f_circleG" id="frotateG_01">
                    </div>
                    <div class="f_circleG" id="frotateG_02">
                    </div>
                    <div class="f_circleG" id="frotateG_03">
                    </div>
                    <div class="f_circleG" id="frotateG_04">
                    </div>
                    <div class="f_circleG" id="frotateG_05">
                    </div>
                    <div class="f_circleG" id="frotateG_06">
                    </div>
                    <div class="f_circleG" id="frotateG_07">
                    </div>
                    <div class="f_circleG" id="frotateG_08">
                    </div>
                </div>
                <div class="consts list-group">
                </div>
            </div>
        </div>
    </div> <!-- /container -->
</body>

</html>